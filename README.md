# DGA Intel
This deep learning model uses a CNN-LSTM architecture to predict whether a given domain name is genuine or was artificially generated by a DGA.

### The Problem
Many forms of malware uses domain generation algorithms (DGAs) to connect with a C&C, which enables it to recieve instructions and perform malicious activities. There have been many attempts to detect whether a given domain name corresponds to a genuine domain, or a fake domain generated by a DGA. Some machine learning methods have utilized clustering based on WHOIS data, etc., to this end. This model builds on past work by using a deep learning architecture to achieve increased accuracy over other methods.

### The Model
This model was based on an architecture from  [2] and implemented in Tensorflow. It embeds domain names, feeds the embeddings through a convolutional network, feeds that through an LSTM, and passes that through a dense layer for classification. This approach captures the local similarity inherent in genuine domains, as well as spatial connections between characters.

### The Data
The training data was a set of 100000 domain names labelled as either 0 (genuine) or 1 (fake) (orginally from the Splunk DGA app). The test data used to examine the model performance consists of two datasets: A set of generated domains from the Bambenek DGA feed, and a set of genuine domains from Alexa's top 1 million domains.

### Results
The model was trained for twenty epochs with the Adam optimizer. It was tested by evaluating its predictive accuracy on 10000 domains each from the shuffled genuine and fake test datasets. It achieved **98.7% accuracy on the fake domains**, and **98.8% accuracy on the genuine domains**.

### Development 
The model can be loaded through Tensorflow's Keras API from the `domain_classifier.h5` file.
To further experiment with the code:

1. Go to Google Colab 
2. Go to File > Open Notebook... > Github
3. Search for https://github.com/sudo-rushil/CNN-LSTM_Domain_Classifier
4. Open `domain_classifier_model.ipynb`

### Usage
    $ git clone https://github.com/sudo-rushil/CNN-LSTM_Domain_Classifier
    $ cd CNN-LSTM_Domain_Classifier
    $ python predict_domain.py [domain name]

### Example
    $ python predict_domain.py wikipedia.com
    
    The domain wikipedia.com is genuine with probability 1.0
#### References
[1] Abadi, *et al.* TensorFlow: Large-scale machine learning on heterogeneous systems, 2015. Software available from tensorflow.org.

[2]  Yu, Bin; Pan, Jie; Hu, Jiaming; Nascimento, Anderson; De Cock, Martine. "Character Level based Detection of DGA Domain Names". 2018 International Joint Conference on Neural Networks (IJCNN).
